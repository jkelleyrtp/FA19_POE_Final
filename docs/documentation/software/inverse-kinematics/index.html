<!DOCTYPE html>
<html lang="en-gb">
    <head>
        <meta charset="UTF-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Olin College Principles of Engineering 2019">
        <meta name="author" content="Jonathan Kelley">
        <title>Inverse Kinematics | Real Steel </title>
        <link rel="stylesheet" href="https:&#x2F;&#x2F;www.getzola.org&#x2F;site.css"/>
        <link rel="icon" href="https:&#x2F;&#x2F;www.getzola.org&#x2F;favicon.ico">
    </head>
    <body>

        <header>
            <nav class="">
                <a class="header__logo white" href="https:&#x2F;&#x2F;www.getzola.org&#x2F;">Real Steel</a>
                <a class="white" href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;" class="nav-link">Docs</a>
                <a class="white" href="https://github.com/jkelleyrtp/FA19_POE_Final/" class="nav-link">GitHub</a>

                <div class="search-container">
                    <input id="search" type="search" placeholder="ðŸ”Ž Search the docs">

                    <div class="search-results">
                        <div class="search-results__items"></div>
                    </div>
                </div>
            </nav>
        </header>

        <div class="content content--reversed">
            

<div class="documentation">
    <aside class="documentation__sidebar">
        <ul>
        
            
            <li>
                <span class="documentation__sidebar__title">Overview</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;overview&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;overview&#x2F;brainstorming&#x2F;">Brainstorming + Inspiration</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;overview&#x2F;systems-design&#x2F;">Systems Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;overview&#x2F;budget&#x2F;">Budget</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Software</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;software&#x2F;systems-overview&#x2F;">Software Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;software&#x2F;human-tracking&#x2F;">Human Tracking</a>
                        </li>
                    
                        <li class="active">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;software&#x2F;inverse-kinematics&#x2F;">Inverse Kinematics</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;software&#x2F;pybullet&#x2F;">PyBullet Simulation</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;software&#x2F;multithreading&#x2F;">Multithreaded Framework</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;software&#x2F;serial-output&#x2F;">Serial Output</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;software&#x2F;references&#x2F;">Serial Output</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Hardware</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;hardware&#x2F;high-level-design&#x2F;">High Level Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;hardware&#x2F;base&#x2F;">Base Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;hardware&#x2F;torso&#x2F;">Torso Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;hardware&#x2F;arm&#x2F;">Arm Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;hardware&#x2F;assembly&#x2F;">Assembly</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Electrical and Firmware</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;ece&#x2F;firmwareoverview&#x2F;">Firmware Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;ece&#x2F;sensors&#x2F;">Sensors</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;ece&#x2F;control-loops-and-feedback&#x2F;">Controls and Feedback</a>
                        </li>
                    
                </ul>
            </li>
        
        </ul>
    </aside>
    <div class="documentation__content">
        
    <h1>Inverse Kinematics</h1>
    <p>Inverse Kinematics is needed to map human movement into robot movement. This is because, calculating joint angles using human extracted joints doesn't translate to robot joint angles. We have different joints than the robot and at different positions and lengths. Instead, using an inverse kinematics solver an articulated body can be programmed to reach a certain target position with its end effector.</p>
<center>
<img src="https://media1.giphy.com/media/HLyej9afegzcc/giphy.gif">
</center>
<p>In RealSteel's robots, we have the following revolute joints in an arm:</p>
<ol>
<li>Shoulder</li>
<li>Proximal</li>
<li>Distal</li>
</ol>
<center>
    <img src="https:&#x2F;&#x2F;www.getzola.org&#x2F;processed_images&#x2F;4e844770dd2f0db800.png" />
</center>
<h3 id="how-does-it-work"><a class="zola-anchor" href="#how-does-it-work" aria-label="Anchor link for: how-does-it-work">ðŸ”—</a>How Does It Work?</h3>
<p>Given a target position, how can we position the articulated body and all it's joints such that the end effector reaches the target? An inverse kinematics solver answers this question with two categories of solutions:</p>
<ol>
<li>Analytic solutions</li>
<li>Approximating solutions</li>
</ol>
<p>We use ikpy, an inverse kinematics library, that can quickly approximate the solution with an iterative optimizer with regularization for smoothing.</p>
<center>
    <img src="https:&#x2F;&#x2F;www.getzola.org&#x2F;processed_images&#x2F;67e66d9bfbb9bd1200.png" />
</center>
<p>ikpy also can import the kinematic chain to solve as long as the robot is defined in URDF format. Luckily for us, we designed our own robot in OnShape and using onshape-to-robot we can convert our OnShape assembly to URDF robot definition.</p>
<h3 id="ikpy-coordinate-system"><a class="zola-anchor" href="#ikpy-coordinate-system" aria-label="Anchor link for: ikpy-coordinate-system">ðŸ”—</a>ikpy Coordinate System</h3>
<p>ikpy defines its kinematic chain to start at the origin in a coordinate system that is rotated 90Â° about the x-axis compared to the Kinect coordinate system. We also run into an issue as the Kinect tracks joint positions with respect to a fixed origin at the center of it's camera lens and not at the base of the kinematic chain - the origin that ikpy expects. Therefore, any target position that we want to solve for with ikpy will be misinterpreted.</p>
<p>The solution is to transform the target joint's (the hand joint) position from the Kinect frame to a frame that has it's origin fixed at the shoulder joint of the arm that is being solved for. The z or depth value is then inverted to place depth in front of the person, and the point is rotated 90Â° about the x-axis. This way now the kinematic chain and target joint position are in the same frame of reference, and ikpy can solve correctly.</p>
<center>
    <img src="https:&#x2F;&#x2F;www.getzola.org&#x2F;processed_images&#x2F;9681e7cec908b60900.png" />
</center>
<h3 id="the-process"><a class="zola-anchor" href="#the-process" aria-label="Anchor link for: the-process">ðŸ”—</a>The Process</h3>
<p>With all the tools in place, we can now proceed with solving for our robot joint angles in real-time in the following steps (note: this is done independently for both arms each)</p>
<ol>
<li>Obtain robot model in URDF format</li>
<li>Import model into ikpy and define a base_element to start the kinematic chain at the shoulder joint of an arm</li>
<li>Obtain target position from the Kinect â†’ the world coordinates for skeletal joint at the hand for the corresponding arm</li>
<li>Perform the necessary transforms to get the target into ikpy coordinate system</li>
<li>Solve for joint angles</li>
</ol>
<p><a href="https://youtu.be/kSUGiyJ5UbY">https://youtu.be/kSUGiyJ5UbY</a></p>


    </div>
</div>

        </div>
        <footer>
            Â©2017-2019 â€” <a class="white" href="https://jonathan-kelley.com">Jonathan Kelley</a> and <a class="white" href="https://github.com/jkelleyrtp/FA19_POE_Final/graphs/contributors">contributors</a>
        </footer>

        <script type="text/javascript" src="https:&#x2F;&#x2F;www.getzola.org&#x2F;elasticlunr.min.js"></script>
        <script type="text/javascript" src="https:&#x2F;&#x2F;www.getzola.org&#x2F;search_index.en.js"></script>
        <script type="text/javascript" src="https:&#x2F;&#x2F;www.getzola.org&#x2F;search.js"></script>
    </body>
</html>
