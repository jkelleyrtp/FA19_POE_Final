<!DOCTYPE html>
<html lang="en-gb">
    <head>
        <meta charset="UTF-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Olin College Principles of Engineering 2019">
        <meta name="author" content="Jonathan Kelley">
        <title>Software Overview | Real Steel </title>
        <link rel="stylesheet" href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;site.css"/>
        <link rel="icon" href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;favicon.ico">
    </head>
    <body>

        <header>
            <nav class="">
                <a class="header__logo white" href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;">Real Steel</a>
                <a class="white" href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;" class="nav-link">Docs</a>
                <a class="white" href="https://github.com/jkelleyrtp/FA19_POE_Final/" class="nav-link">GitHub</a>

                <div class="search-container">
                    <input id="search" type="search" placeholder="ðŸ”Ž Search the docs">

                    <div class="search-results">
                        <div class="search-results__items"></div>
                    </div>
                </div>
            </nav>
        </header>

        <div class="content content--reversed">
            

<div class="documentation">
    <aside class="documentation__sidebar">
        <ul>
        
            
            <li>
                <span class="documentation__sidebar__title">Overview</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;overview&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;overview&#x2F;brainstorming&#x2F;">Brainstorming + Inspiration</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;overview&#x2F;budget&#x2F;">Budget</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Software</span>
                <ul>
                    
                        <li class="active">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;software&#x2F;systems-overview&#x2F;">Software Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;software&#x2F;human-tracking&#x2F;">Human Tracking</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;software&#x2F;inverse-kinematics&#x2F;">Inverse Kinematics</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;software&#x2F;pybulletsimulation&#x2F;">PyBullet Simulation</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;software&#x2F;multithreading&#x2F;">Multithreaded Framework</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;software&#x2F;serialoutput&#x2F;">Serial Output</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Hardware</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;hardware&#x2F;highlevel&#x2F;">High Level Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;hardware&#x2F;base&#x2F;">Base Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;hardware&#x2F;torso&#x2F;">Torso Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;hardware&#x2F;shoulder&#x2F;">Shoulder Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;hardware&#x2F;arm&#x2F;">Arm Design</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;hardware&#x2F;assembly&#x2F;">Assembly</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Electrical and Firmware</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;ece&#x2F;firmware&#x2F;">Firmware Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;ece&#x2F;sensors&#x2F;">Sensors</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;documentation&#x2F;ece&#x2F;controls&#x2F;">Controls and Feedback</a>
                        </li>
                    
                </ul>
            </li>
        
        </ul>
    </aside>
    <div class="documentation__content">
        
    <h1>Software Overview</h1>
    <p>The software powering Real Steel is fairly complex, but we chose a handful of architectural patterns and libraries to simplify the development process. Our language of choice was Python and we relied heavily on <code>OpenNI</code> for kinect-related libraries, Python's <code>Multiprocessing</code> library for concurrency, <code>ikpy</code> for forward kinematic solving, <code>pybullet</code> for simulation of the robot, and <code>PySerial</code> to get the joint angle to the robot.</p>
<center>
    <img src="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;processed_images&#x2F;bc534068cff6a41400.png" />
</center>
<p>All of these components were given their own <code>class</code> in the Python code, and inherited certain functionality so that we could easily disable and enable different parts of the code with a few flags. For instance, the python code that loads in all the modules is fairly simple, despite the entire codebase being several thousand lines. We chose the pipeline architecture and separated each of the components into their own submodules to be more easily unit-testable. The entire system can run with &quot;fake&quot; components which satisfy the software requirements and even create fake data so we can do integration tests with entire chunks of the pipeline missing. This is a solid, industry-practiced software engineering tactic that allowed us to iterate faster and modularize our code.</p>
<pre style="background-color:#383838;">
<span style="color:#f92672dd;">from </span><span style="color:#e6e1dc;">realsteel.device </span><span style="color:#f92672dd;">import </span><span style="color:#da4939;">ROBOT_DEVICE</span><span style="color:#e6e1dc;">, </span><span style="color:#da4939;">FAKE_DEVICE
</span><span style="color:#f92672dd;">from </span><span style="color:#e6e1dc;">realsteel.visualizer </span><span style="color:#f92672dd;">import </span><span style="color:#da4939;">DEMO_VIS</span><span style="color:#e6e1dc;">, </span><span style="color:#da4939;">ROBOT_VIS</span><span style="color:#e6e1dc;">, </span><span style="color:#da4939;">FAKE_VIS
</span><span style="color:#f92672dd;">from </span><span style="color:#e6e1dc;">realsteel.joint_input </span><span style="color:#f92672dd;">import </span><span style="color:#da4939;">CAMERA</span><span style="color:#e6e1dc;">, </span><span style="color:#da4939;">KINECT</span><span style="color:#e6e1dc;">, </span><span style="color:#da4939;">HYBRID
</span><span style="color:#f92672dd;">from </span><span style="color:#e6e1dc;">realsteel.kinematic </span><span style="color:#f92672dd;">import </span><span style="color:#da4939;">KSOLVER
</span><span style="color:#f92672dd;">from </span><span style="color:#e6e1dc;">realsteel.pathplanner </span><span style="color:#f92672dd;">import </span><span style="color:#da4939;">PATHPLANNER
</span><span style="color:#f92672dd;">from </span><span style="color:#e6e1dc;">realsteel.kinematic </span><span style="color:#f92672dd;">import </span><span style="color:#e6e1dc;">ArmJoints


</span><span style="font-style:italic;color:#3bc0f0;">class </span><span style="text-decoration:underline;color:#ffc66d;">ROBOT</span><span style="color:#e6e1dc;">:
    </span><span style="color:#95815e;">&quot;&quot;&quot;
    This code processes the launch args and sets up all the moving parts to get the REAL STEEL experience up and running.
    Nothing in this main loop should blocking, but rather pushing data around between threads. Everything should be async.

    &quot;&quot;&quot;
    </span><span style="font-style:italic;color:#3bc0f0;">def </span><span style="color:#da4939;">__init__</span><span style="color:#e6e1dc;">(</span><span style="font-style:italic;color:#fd971f;">self</span><span style="color:#e6e1dc;">, </span><span style="font-style:italic;color:#fd971f;">hardware_enabled </span><span style="color:#cc7833;">= </span><span style="color:#6e9cbe;">False</span><span style="color:#e6e1dc;">, </span><span style="font-style:italic;color:#fd971f;">visualization_mode</span><span style="color:#cc7833;">=</span><span style="color:#c1be91;">&quot;disabled&quot;</span><span style="color:#e6e1dc;">):
        </span><span style="color:#95815e;"># [1] Build the virtual robot from joints
        # [2] Set up the camera/kinect inputs to dump raw joint angles
        # [3] Set up the kinematic solver that takes raw joint angles and turns into robot angles
        # [4] Set up the path planner that maps joint angles frames
        # [5] Set up the physical robot interface
        # [6] Set up the visualizer

        # Process the user flags to process things like dev mode
        </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.hardware_enabled: </span><span style="font-style:italic;color:#6e9cbe;">bool </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">hardware_enabled
        </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.visualization_mode </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">visualization_mode

        </span><span style="color:#95815e;"># [1] Build the robot from a URDF file
        # TODO, allow specifying a custon URDF
        </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.human_positions: </span><span style="font-style:italic;color:#6e9cbe;">dict </span><span style="color:#cc7833;">= </span><span style="color:#6e9cbe;">None
        </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.robot_positions: </span><span style="font-style:italic;color:#6e9cbe;">dict </span><span style="color:#cc7833;">= </span><span style="color:#6e9cbe;">None
        </span><span style="color:#95815e;"># self.intialize_robot_from_urdf(file = &quot;&quot;)

        # [2] Set up the camera/kinect input device
        </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.joint_input </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">HYBRID()

        </span><span style="color:#95815e;"># [3] Set up the kinematic solver 
        </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.solver </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">KSOLVER()

        </span><span style="color:#95815e;"># [4] Set up the path planner
        </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.planner </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">PATHPLANNER()

        </span><span style="color:#95815e;"># [5] Set up the hardware device
        </span><span style="color:#cc7833;">if </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.hardware_enabled:
            </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.device </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">ROBOT_DEVICE()
        </span><span style="color:#cc7833;">else</span><span style="color:#e6e1dc;">:
            </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.device </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">FAKE_DEVICE()

        </span><span style="color:#95815e;"># [6] Set up the visualizer
        </span><span style="color:#cc7833;">if </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.visualization_mode </span><span style="color:#cc7833;">== </span><span style="color:#c1be91;">&quot;dev&quot;</span><span style="color:#e6e1dc;">:
            </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.visualizer </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">ROBOT_VIS(</span><span style="font-style:italic;color:#fd971f;">directory</span><span style="color:#cc7833;">=</span><span style="color:#a5c261;">&#39;robot/&#39;</span><span style="color:#e6e1dc;">)

        </span><span style="color:#cc7833;">elif </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.visualization_mode </span><span style="color:#cc7833;">== </span><span style="color:#c1be91;">&quot;demo&quot;</span><span style="color:#e6e1dc;">:
            </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.visualizer </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">DEMO_VIS()

        </span><span style="color:#cc7833;">else</span><span style="color:#e6e1dc;">:
            </span><span style="color:#d0d0ff;">self</span><span style="color:#e6e1dc;">.visualizer </span><span style="color:#cc7833;">= </span><span style="color:#e6e1dc;">FAKE_VIS()
</span></pre>

    </div>
</div>

        </div>
        <footer>
            Â©2017-2019 â€” <a class="white" href="https://jonathan-kelley.com">Jonathan Kelley</a> and <a class="white" href="https://github.com/jkelleyrtp/FA19_POE_Final/graphs/contributors">contributors</a>
        </footer>

        <script type="text/javascript" src="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;elasticlunr.min.js"></script>
        <script type="text/javascript" src="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;search_index.en.js"></script>
        <script type="text/javascript" src="https:&#x2F;&#x2F;jonathan-kelley.com&#x2F;FA19_POE_Final&#x2F;search.js"></script>
    </body>
</html>
